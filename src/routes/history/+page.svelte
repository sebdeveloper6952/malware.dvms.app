<script lang="ts">
	import { onDestroy, onMount } from 'svelte';
	import { getUserJobResultsStore } from '@lib/stores/userJobResults';
	import type { NDKEventStore } from '@nostr-dev-kit/ndk-svelte';
	import type { Nip90JobResultEvent } from '@lib/models/Nip90JobResult';
	import JobResultCard from '@lib/components/cards/JobResultCard.svelte';

	let store: NDKEventStore<Nip90JobResultEvent> | null;

	onMount(() => {
		store = getUserJobResultsStore();
		store?.ref();
	});

	onDestroy(() => {
		store?.unref();
	});
</script>

<div class="w-full flex flex-col items-center">
	<div class="w-full md:max-w-screen-md flex flex-col gap-2">
		{#if $store}
			{#each $store as event}
				<JobResultCard {event} />
			{/each}
		{/if}
	</div>
</div>
