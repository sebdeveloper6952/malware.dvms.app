<script lang="ts">
	import { goto } from '$app/navigation';
	import Icon from '@iconify/svelte';
	import { page } from '$app/stores';
	import { logout, userStore } from '@lib/nostr/nsecSigner';
	import UserAvatar from '../UserAvatar.svelte';
	import { navigationItems } from '@lib/helpers/navigationItems';
	import { createEventDispatcher } from 'svelte';

	const dispatch = createEventDispatcher();
</script>

<div class="flex h-full bg-zinc-900 text-gray-50">
	<aside class="flex h-full w-20 flex-col items-center border-r border-zinc-700 bg-zinc-900">
		<button
			on:click={() => goto('/')}
			class="flex h-[4.5rem] w-full items-center justify-center border-b border-zinc-700 p-2"
		>
			<Icon icon="pixelarticons:debug-check" width="48" height="48" />
		</button>
		<nav class="w-full flex flex-1 flex-col gap-y-8 pt-6">
			{#each navigationItems as item, i}
				<a
					href={item.path}
					class="flex flex-col justify-center items-center border-none hover:text-orange-700"
					class:text-orange-700={$page.url.pathname === item.path}
					class:border-r-4={$page.url.pathname === item.path}
				>
					<Icon icon={item.icon} width="32" height="32" />
					<p class="text-xs">{item.name}</p>
				</a>
			{/each}
			<a href="/scan" class="px-2 flex flex-col justify-center items-center border-none">
				<div class="w-full p-2 flex flex-col justify-center items-center bg-orange-700 rounded">
					<Icon icon="pixelarticons:debug-play" width="24" height="24" />
					<p class="text-xs">Scan</p>
				</div>
			</a>
		</nav>
		<div class="flex flex-col items-center gap-y-4 py-4">
			{#if $userStore}
				<button
					on:click={() => logout()}
					class="flex flex-col justify-center items-center border-none text-zinc-400 hover:text-orange-700"
				>
					<Icon icon="pixelarticons:logout" width="24" height="24" />
					<p class="text-xs">Logout</p>
				</button>
			{:else}
				<button
					on:click={() => {
						dispatch('login');
					}}
					class="flex flex-col justify-center items-center border-none text-zinc-400 hover:text-orange-700"
				>
					<Icon icon="pixelarticons:logout" width="24" height="24" />
					<p class="text-xs">Login</p>
				</button>
			{/if}
			<UserAvatar />
		</div>
	</aside>
</div>
